<script lang="ts">
	import Axis from './Axis.svelte'
	import Line from './Line.svelte'

	const options = {
		xMin: 0,
		xMax: 1000,
		yMin: 0,
		yMax: 100,
		line: {
			smoothing: 0.15,
			flattening: 0.5,
		},
	}
	const svg = {
		w: 0,
		h: 0,
	}
	const datasets = [
		{
			name: 'one',
			colors: {
				path: '#B4DC7F',
				circles: 'red',
			},
			// prettier-ignore
			values: [
				// prettier-ignore
				[0,100],[11.3,69.31619140266353],[22.6,76.65937358039919],[33.9,77.57196274620811],[45.2,63.49275851194229],[56.5,25.452247041365585],[67.8,7.220513645444143],[79.1,2.608353062570427],[90.4,0.9623412806132525],[101.7,1.4044275770878987],[113,1.009169689466604],[124.3,2.782296232429307],[135.6,4.212872487938557],[146.9,10.23007601288788],[158.2,13.102738449310278],[169.5,10.359111983831559],[180.8,5.343286414208703],[192.1,2.243314507209362],[203.4,3.6942526990255047],[214.7,4.344679045845674],[226,3.345959005020107],[237.3,2.017692234532989],[248.6,4.693157638251134],[259.9,5.022707256950187],[271.2,5.59010266599225],[282.5,7.515773278044089],[293.8,14.63730849870473],[305.1,17.82803662975979],[316.4,18.427309678587644],[327.7,17.158744868058236],[339,15.389249845234263],[350.3,15.428430971822523],[361.6,18.01929091232453],[372.9,17.599542653807447],[384.2,17.870060569249016],[395.5,19.524092319308906],[406.8,20.559315348959327],[418.1,31.712190386184574],[429.4,34.45678756826362],[440.7,36.306892515439884],[452,37.6906952538083],[463.3,44.683887872525496],[474.6,58.469716126642],[485.9,62.88000521413488],[497.2,62.93029757895191],[508.5,67.15663587068252],[519.8,62.503112937907304],[531.1,51.205693576433134],[542.4,45.778954424971175],[553.7,43.059480313000634],[565,43.864527946873146],[576.3,49.42964043848193],[587.6,49.13602177918254],[598.9,47.93172071882489],[610.2,49.45422614761525],[621.5,45.920159021868976],[632.8,34.91145851209253],[644.1,27.37122086449016],[655.4,32.399261284667155],[666.7,36.43667963613382],[678,36.53279213571635],[689.3,35.61959627203223],[700.6,44.02348279017695],[711.9,46.09212609007719],[723.2,41.10443396763885],[734.5,40.71781719118298],[745.8,39.81574412187763],[757.1,36.165034996066865],[768.4,30.289391419627957],[779.7,33.30446607062356],[791,32.73461497970567],[802.3,33.15157820607181],[813.6,32.45035680190945],[824.9,30.081299826507518],[836.2,33.67273745894822],[847.5,39.521276085552955],[858.8,42.160902979071466],[870.1,44.3057590882475],[881.4,52.07893405147872],[892.7,52.09326367748357],[904,42.32896406857836],[915.3,39.996909885488954],[926.6,43.027758681239895],[937.9,39.67027530562839],[949.2,33.20333820193933],[960.5,28.122110601369332],[971.8,28.45801321353304],[983.1,23.31110623441581],[994.4,19.859214891347342],[1005.7,18.52413865947042],[1017,25.764216866871188],[1028.3,24.555605362562073],[1039.6,21.99471051902021],[1050.9,20.792801581713363],[1062.2,16.0629213877873],[1073.5,12.825344624616381],[1084.8,6.688422274664031],[1096.1,2.189480182416139],[1107.4,0.657140469972442],[1118.7,0]
				// prettier-ignore
			],
			// prettier-ignore
		},
	]

	function watchResize(container: HTMLElement) {
		function resize() {
			svg.w = container.offsetWidth
			svg.h = container.offsetHeight
		}
		resize()

		window.addEventListener('resize', resize)

		return {
			destroy() {
				window.removeEventListener('resize', resize)
			},
		}
	}
</script>

<pre>
	Smoothing <input
		type="range"
		min="0"
		max="0.25"
		step="0.01"
		bind:value={options.line.smoothing} /> 
	Flattening <input
		type="range"
		min="0"
		max="1"
		step="0.01"
		bind:value={options.line.flattening} />
</pre>
<div class="container" use:watchResize>
	<!-- <svg-chart :datasets="datasets" :options="options" :svg="svg"></svg-chart> -->
	<svg viewBox="0 0 {svg.w} {svg.h}">
		{#each datasets as dataset}
			<Line {svg} {options} {dataset} />
		{/each}
		<Axis {svg} {options} />
	</svg>
</div>

<style>
	*,
	*:before,
	*:after {
		box-sizing: inherit;
	}

	.container {
		margin: 40px;
		height: 400px;
		background-color: #f7f5f2;
	}
</style>
